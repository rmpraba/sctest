
<link rel="import" href="..\..\bower_components/polymer/polymer.html">

<dom-module id="categorywise-report">
  <template>
    <style>
      :host {
        display: block;
      }
      table{
        width: 70%;
      }
      #btn2{
            width: 10%;
            background: #252626;
            color: white;
            margin-top: 2%;
            height: 45px;
            border-radius: 2px;
            /*font-weight: bold;*/
            font-family: Calibri;
            font-size: 17px;
            margin-left: 40%;
          }
    </style>
    <div class="card" hidden$="{{hidetop}}">
      <center><h1>{{schoolname}}</h1>
      <div id="hidetop">
      <h3>Categorywise Report -AY-{{academicyear}}</h3>  
      <h4> Grade: {{grade}} - &nbsp&nbsp{{section}} &nbsp&nbsp Term: {{termname}} &nbsp;&nbsp;Subject: {{subject}} </h4>
      <table border="1" style="border-collapse: collapse;" id="categorywisereport">  
      <tr hidden$="{{hideeng}}">
        <th>Sno</th><th>Student Name</th><th colspan="6">Reading Skills</th><th colspan="10">Writing Skills</th><th colspan="4">Speaking Skills</th><th colspan="2">Listening Skills</th><th colspan="2">Written Work</th>
      </tr> 
      <tr hidden$="{{hidemath}}">
        <th>Sno</th><th>Student Name</th><th colspan="2">Concept</th><th colspan="4">Activity/Project</th><th colspan="4">Mental Ability</th><th colspan="4">Table Activity</th><th colspan="2">Written Work</th>
      </tr>
      <tr hidden$="{{hideevs}}">
        <th>Sno</th><th>Student Name</th><th colspan="2">Environmental sensitivity</th><th colspan="6">Activity/Project</th><th colspan="6">Group Discussion</th><th colspan="2">Written Work</th>
      </tr>
      <tr hidden$="{{hidecomp}}">
        <th>Sno</th><th>Student Name</th><th colspan="2">Activity</th>
      </tr>
       <tr hidden$="{{hidesub1}}">
       <!-- <th>Sno</th><th>Student Name</th>        -->
       <th></th><th></th>
        <template is="dom-repeat" items="{{subjectarr}}" as="subject"> 
        <th colspan="2">{{subject}}</th>
        </template>
       </tr>
       <tr hidden$="{{hidesub2}}">
       <th>Sno</th><th>Student Name</th>       
        <template is="dom-repeat" items="{{subjectarr}}" as="subject"> 
        <th colspan="2">{{subject}}</th>
        </template>
       </tr>
       <tr>
        <th></th><th></th>
        <template is="dom-repeat" items="{{titlearr}}" as="title"> 
        <th>{{title}}</th>
        </template>
       </tr>     
      <template is="dom-repeat" items="{{itemarr}}" as="i">
        <tr>
      <template is="dom-repeat" items="{{i}}" as="item">
        <td>{{item}}</td>
      </template>
        </tr>
      </template>
      </table>

      <div hidden id="categorywiseengreport">
      <tr hidden$="{{hideeng}}"><th>
      <h3>Categorywise Report -AY-{{academicyear}}</h3>  
      <h4> Grade: {{grade}} - &nbsp&nbsp{{section}} &nbsp&nbsp Term: {{termname}} &nbsp;&nbsp;Subject: {{subject}} </h4> </th>
      </tr> 
      <table border="1" style="border-collapse: collapse;" >
      
      <tr hidden$="{{hideeng}}">
        <th>Sno</th><th>Student Name</th><th colspan="6">Reading Skills</th><th colspan="10">Writing Skills</th><th colspan="4">Speaking Skills</th><th colspan="2">Listening Skills</th><th colspan="2">Written Work</th>
      </tr> 
     
       <tr hidden$="{{hidesub1}}">
       <!-- <th>Sno</th><th>Student Name</th>        -->
       <th></th><th></th>
        <template is="dom-repeat" items="{{subjectarr}}" as="subject"> 
        <th colspan="2">{{subject}}</th>
        </template>
       </tr>
       <tr>
        <th></th><th></th>
        <template is="dom-repeat" items="{{titlearr}}" as="title"> 
        <th>{{title}}</th>
        </template>
       </tr>     
      <template is="dom-repeat" items="{{itemarr}}" as="i">
        <tr>
      <template is="dom-repeat" items="{{i}}" as="item">
        <td>{{item}}</td>
      </template>
        </tr>
      </template>
      </table>
      </div>

      <div hidden id="categorywisemathreport">
     <tr hidden$="{{hidemath}}">
       <h3>Categorywise Report -AY-{{academicyear}}</h3>  
      <h4> Grade: {{grade}} - &nbsp&nbsp{{section}} &nbsp&nbsp Term: {{termname}} &nbsp;&nbsp;Subject: {{subject}} </h4>
      </tr>
      <table border="1" style="border-collapse: collapse;" >  
      
      <tr hidden$="{{hidemath}}">
         <th>Sno</th><th>Student Name</th><th colspan="2">Concept</th><th colspan="4">Activity/Project</th><th colspan="4">Mental Ability</th><th colspan="4">Table Activity</th><th colspan="2">Written Work</th>
      </tr> 
     
       <tr hidden$="{{hidesub1}}">
       <!-- <th>Sno</th><th>Student Name</th>        -->
       <th></th><th></th>
        <template is="dom-repeat" items="{{subjectarr}}" as="subject"> 
        <th colspan="2">{{subject}}</th>
        </template>
       </tr>
       <tr>
        <th></th><th></th>
        <template is="dom-repeat" items="{{titlearr}}" as="title"> 
        <th>{{title}}</th>
        </template>
       </tr>     
      <template is="dom-repeat" items="{{itemarr}}" as="i">
        <tr>
      <template is="dom-repeat" items="{{i}}" as="item">
        <td>{{item}}</td>
      </template>
        </tr>
      </template>
      </table>
      </div>

      <div hidden id="categorywiseevsreport">
      <tr hidden$="{{hideevs}}">
        <th><h3>Categorywise Report -AY-{{academicyear}}</h3>  
      <h4> Grade: {{grade}} - &nbsp&nbsp{{section}} &nbsp&nbsp Term: {{termname}} &nbsp;&nbsp;Subject: {{subject}} </h4> </th>
      </tr>
      <table border="1" style="border-collapse: collapse;" > 
      
      <tr hidden$="{{hideevs}}">
         <th>Sno</th><th>Student Name</th><th colspan="2">Environmental sensitivity</th><th colspan="6">Activity/Project</th><th colspan="6">Group Discussion</th><th colspan="2">Written Work</th>
      </tr> 
     
       <tr hidden$="{{hidesub1}}">
       <!-- <th>Sno</th><th>Student Name</th>        -->
       <th></th><th></th>
        <template is="dom-repeat" items="{{subjectarr}}" as="subject"> 
        <th colspan="2">{{subject}}</th>
        </template>
       </tr>
       <tr>
        <th></th><th></th>
        <template is="dom-repeat" items="{{titlearr}}" as="title"> 
        <th>{{title}}</th>
        </template>
       </tr>     
      <template is="dom-repeat" items="{{itemarr}}" as="i">
        <tr>
      <template is="dom-repeat" items="{{i}}" as="item">
        <td>{{item}}</td>
      </template>
        </tr>
      </template>
      </table>
      </div>

      <div hidden id="categorywisecompreport">
      <tr hidden$="{{hidecomp}}">
        <td><h3>Categorywise Report -AY-{{academicyear}}</h3>  
      <h4> Grade: {{grade}} - &nbsp&nbsp{{section}} &nbsp&nbsp Term: {{termname}} &nbsp;&nbsp;Subject: {{subject}} </h4> </td>
      </tr>
      <table border="1" style="border-collapse: collapse;" > 
       
      <tr hidden$="{{hidecomp}}">
          <th>Sno</th><th>Student Name</th><th colspan="2">Activity</th>
      </tr> 
     
       <tr hidden$="{{hidesub1}}">
       <!-- <th>Sno</th><th>Student Name</th>        -->
       <th></th><th></th>
        <template is="dom-repeat" items="{{subjectarr}}" as="subject"> 
        <th colspan="2">{{subject}}</th>
        </template>
       </tr>
       <tr>
        <th></th><th></th>
        <template is="dom-repeat" items="{{titlearr}}" as="title"> 
        <th>{{title}}</th>
        </template>
       </tr>     
      <template is="dom-repeat" items="{{itemarr}}" as="i">
        <tr>
      <template is="dom-repeat" items="{{i}}" as="item">
        <td>{{item}}</td>
      </template>
        </tr>
      </template>
      </table>
      </div>

      <div hidden id="categorywisegeneralreport">
      <tr hidden$="{{hidesub2}}">
        <td>
          <h3>Categorywise Report -AY-{{academicyear}}</h3>  
      <h4> Grade: {{grade}} - &nbsp&nbsp{{section}} &nbsp&nbsp Term: {{termname}} &nbsp;&nbsp;Subject: {{subject}} </h4>
        </td>
      </tr>
      <table border="1" style="border-collapse: collapse;"  hidden>
       
        <tr hidden$="{{hidesub2}}">
       <th>Sno</th><th>Student Name</th>       
        <template is="dom-repeat" items="{{subjectarr}}" as="subject"> 
        <th colspan="2">{{subject}}</th>
        </template>
       </tr>
       <tr>
        <th></th><th></th>
        <template is="dom-repeat" items="{{titlearr}}" as="title"> 
        <th>{{title}}</th>
        </template>
       </tr>     
      <template is="dom-repeat" items="{{itemarr}}" as="i">
        <tr>
      <template is="dom-repeat" items="{{i}}" as="item">
        <td>{{item}}</td>
      </template>
        </tr>
      </template>
      </table>
      </div>
      </div>
    </div>
    <input type="button" hidden$="{{hideeng}}" id="btn2" onclick="tableToExcel('categorywiseengreport', 'Categorywise Report')" value="Export to Excel">
    <input type="button" hidden$="{{hidemath}}" id="btn2" onclick="tableToExcel('categorywisemathreport', 'Categorywise Report')" value="Export to Excel">
    <input type="button" hidden$="{{hideevs}}" id="btn2" onclick="tableToExcel('categorywiseevsreport', 'Categorywise Report')" value="Export to Excel">
    <input type="button" hidden$="{{hidecomp}}" id="btn2" onclick="tableToExcel('categorywisecompreport', 'Categorywise Report')" value="Export to Excel">
    <input type="button" hidden$="{{hidesub2}}" id="btn2" onclick="tableToExcel('categorywisegeneralreport', 'Categorywise Report')" value="Export to Excel">
  </template>
  <script type="text/javascript">
  var tableToExcel = (function() {
  var uri = 'data:application/vnd.ms-excel;base64,'
    , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
    , base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) }
    , format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
  return function(table, name) {
    if (!table.nodeType) table = document.getElementById(table)
    var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}
    window.location.href = uri + base64(format(template, ctx))
  }
})()
</script>
  <script>
  (function() {
    'use strict';
    Polymer({
      is: 'categorywise-report',
        ready:function(){
          this.hidetop=true;
          this.hidecomp=true;
          this.hideevs=true;
          this.hidemath=true;
          this.hideeng=true;
          this.hidesub1=true;
          this.hidesub2=true;
        },
        setDefaultHeaders:function(){ 
        // alert('coming');    
         this.itemarr="";
        this.subjectarr="";
        this.titlearr="";      
        this.schoolname=sessionStorage.getItem("curr_sess_loggedschoolname");
        this.academicyear=localStorage.getItem("curr_sess_academicyear");
        this.grade=localStorage.getItem("curr_sess_grade");
        this.section=localStorage.getItem("curr_sess_section");
        this.subject=localStorage.getItem("curr_sess_subject");
        this.termname=localStorage.getItem("curr_sess_termname");
        this.assesment=localStorage.getItem("curr_sess_assesment");
        this.hidetop=false;
      },
      FnRefresh:function(){
        this.hidetop=true;
        this.itemarr="";
        this.subjectarr="";
        this.titlearr="";
      },
      FnHideView:function(){
        if(localStorage.getItem("curr_sess_subject")=="English"||localStorage.getItem("curr_sess_subject")=="II Language Hindi"||localStorage.getItem("curr_sess_subject")=="II Language Kannada")
        {
          // this.hidetop=true;
          this.hidecomp=true;
          this.hideevs=true;
          this.hidemath=true;
          this.hideeng=false;
          this.hidesub1=false;
          this.hidesub2=true;
        }
        else if(localStorage.getItem("curr_sess_subject")=="Evs")
        {
          // this.hidetop=true;
          this.hidecomp=true;
          this.hideevs=false;
          this.hidemath=true;
          this.hideeng=true;
          this.hidesub1=false;
          this.hidesub2=true;
        }
        else if(localStorage.getItem("curr_sess_subject")=="Mathematics")
        {
          // this.hidetop=true;
          this.hidecomp=true;
          this.hideevs=true;
          this.hidemath=false;
          this.hideeng=true;
          this.hidesub1=false;
          this.hidesub2=true;
        }
        else{
          this.hidesub2=false;
          this.hidesub1=true;
          this.hidecomp=true;
          this.hideevs=true;
          this.hidemath=true;
          this.hideeng=true;
        }
      }
    });
  })();
  </script>
</dom-module>
